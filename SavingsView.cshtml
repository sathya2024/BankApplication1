@{
    ViewBag.Title = "Savings Account";
    Layout = "~/Shared/_LayoutPage1.cshtml";
}

<style>
    .pastel-card {
        background-color: #f8fbff;
        border: 1px solid #a3c4f3;
        color: #333;
        border-radius: 0.5rem;
    }

        .pastel-card .card-header {
            background-color: #e3f0ff;
            color: #6fa8dc;
            font-weight: 600;
            border-bottom: 1px solid #a3c4f3;
        }
</style>

<div class="container mt-4">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h3 class="mb-0">Savings Account Overview</h3>
        <div>
            <button id="viewTransactionsBtn" class="btn btn-outline-primary btn-sm">Transactions</button>
            <button id="backBtn" class="btn btn-outline-secondary btn-sm d-none">Back</button>
        </div>
    </div>

    <div id="sbDetails">
        @Html.Action("SavingsDetails", "Customer", new { id = ViewBag.CustomerId })
    </div>

    <div class="row" id="transactionForms">
        <div class="col-md-6">
            @Html.Action("DepositForm", "Customer", new { id = ViewBag.CustomerId })
        </div>
        <div class="col-md-6">
            @Html.Action("WithdrawForm", "Customer", new { id = ViewBag.CustomerId })
        </div>
    </div>

    <div id="transactionsContainer" class="mt-4"></div>
</div>

@section Scripts {
    <script>
        $(document).ready(function () {
            // Load top 3 transactions
            $('#viewTransactionsBtn').click(function () {
                $('#transactionsContainer').load('/Customer/SavingsTransactions?id=@ViewBag.CustomerId', function () {
                    $('#transactionForms').hide();
                    $('#viewTransactionsBtn').addClass('d-none');
                    $('#backBtn').removeClass('d-none');

                    // Attach click handler to View All button after partial loads
                    $('#transactionsContainer').on('click', '#viewAllTxnsBtn', function () {
                        $('#transactionsContainer').load('/Customer/ViewAllTransactions?id=@ViewBag.CustomerId');
                    });
                });
            });

            // Back button
            $('#backBtn').click(function () {
                $('#transactionsContainer').empty();
                $('#transactionForms').show();
                $('#backBtn').addClass('d-none');
                $('#viewTransactionsBtn').removeClass('d-none');
            });
        });
    </script>
}